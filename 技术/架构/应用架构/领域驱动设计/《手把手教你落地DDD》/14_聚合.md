## 聚合的基础理论

聚合是保护业务规则的有效手段。

聚合具有两个重要特征：

1. **具有整体部分关系**。也就是说聚合是一个逻辑上的整体
2. **具有不变规则**。而且这种不变规则在并发的时候可能被破坏。要防止规则的破坏，仅仅锁住一条记录是不够的，必须把聚合作为一个整体锁住才能解决。或者说，聚合确定了一个事务边界。

根据聚合的两个重要特征可以得到以下的推论：

1. 作为部分的实体，只能属于一个聚合根，不能属于多个聚合根
2. 作为部分的实体，只能属于一个聚合根的部分，不能属于多个聚合根的部分
3. 聚合根被删除，作为其部分的实体也会被删除
4. 聚合根拥有一个全局唯一的标识，而从属于聚合根的部分只需要拥有局部于聚合根的唯一标识

聚合的作用：

其**基本作用**是为一组具有整体部分关系的实体维护不变规则，除此之外，还拥有：

1. 为我们提供一个新的技术视角，可以更细致的和业务人员讨论业务规则
2. 在模型上为每个聚合创建了一个包，使得模块更清晰，降低了认知负载
3. 其能够作为一个事务边界，给出了事务的范围下限，为开发时确定事务范围提供了参考





## 聚合的封装

