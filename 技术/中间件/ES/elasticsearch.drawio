<mxfile host="Electron" modified="2024-02-19T07:39:39.041Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/23.0.2 Chrome/120.0.6099.109 Electron/28.1.0 Safari/537.36" etag="WU4jJ-X2tReEm-pBnGrs" version="23.0.2" type="device" pages="2">
  <diagram name="索引状态管理" id="cjM-u49rfSf1OG_A7p2E">
    <mxGraphModel dx="4692" dy="694" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="3300" pageHeight="4681" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="lKorZ_jzjAWArkaiL7zM-21" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" edge="1" parent="1" source="lKorZ_jzjAWArkaiL7zM-1" target="lKorZ_jzjAWArkaiL7zM-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-1" value="index" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="210" y="100" width="300" height="360" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-2" value="shard1(master)" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="240" y="170" width="240" height="220" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-4" value="&lt;b&gt;主分片&amp;nbsp;&lt;/b&gt;&lt;br&gt;每个主分片是一个Lucence索引&lt;br&gt;一个Lucene索引又包含一到多个段(segment)" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#dae8fc;strokeColor=#6c8ebf;fillStyle=solid;direction=west;gradientDirection=north;shadow=1;size=20;pointerEvents=1;align=left;verticalAlign=top;spacingTop=0;spacing=6;labelBackgroundColor=none;labelBorderColor=none;" vertex="1" parent="1">
          <mxGeometry x="-20" y="77.5" width="160" height="130" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-5" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=-0.006;entryY=0.717;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="lKorZ_jzjAWArkaiL7zM-2" target="lKorZ_jzjAWArkaiL7zM-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-6" value="segment1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="280" y="207.5" width="160" height="62.5" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-11" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="lKorZ_jzjAWArkaiL7zM-9" target="lKorZ_jzjAWArkaiL7zM-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-9" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;direction=west;" vertex="1" parent="1">
          <mxGeometry x="251" y="205" width="20" height="145" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-10" value="&lt;b&gt;合并索引&amp;nbsp;&lt;/b&gt;&lt;br&gt;把分片内部很多零碎的小段合并成大段并去除被删除的文档" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#dae8fc;strokeColor=#6c8ebf;fillStyle=solid;direction=west;gradientDirection=north;shadow=1;size=20;pointerEvents=1;align=left;verticalAlign=top;spacingTop=0;spacing=6;labelBackgroundColor=none;labelBorderColor=none;" vertex="1" parent="1">
          <mxGeometry x="-20" y="320" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-12" value="doc1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="290" y="240" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-13" value="doc2" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="370" y="240" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-14" value="segment2" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="280" y="280" width="160" height="62.5" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-15" value="doc1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="290" y="312.5" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-16" value="doc2" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=middle;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="312.5" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-17" value="&lt;b&gt;关闭索引&amp;nbsp;&lt;/b&gt;&lt;br&gt;部分索引在业务中不需要使用但是又不能够将其直接删除，这时可以使用关闭索引的操作使索引不再接收读写请求" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#dae8fc;strokeColor=#6c8ebf;fillStyle=solid;direction=west;gradientDirection=north;shadow=1;size=20;pointerEvents=1;align=left;verticalAlign=top;spacingTop=0;spacing=6;labelBackgroundColor=none;labelBorderColor=none;" vertex="1" parent="1">
          <mxGeometry x="590" y="50" width="160" height="120" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-18" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.957;exitY=0.036;exitDx=0;exitDy=0;entryX=1.019;entryY=0.755;entryDx=0;entryDy=0;entryPerimeter=0;exitPerimeter=0;" edge="1" parent="1" source="lKorZ_jzjAWArkaiL7zM-1" target="lKorZ_jzjAWArkaiL7zM-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lKorZ_jzjAWArkaiL7zM-20" value="&lt;b&gt;冻结索引&amp;nbsp;&lt;/b&gt;&lt;br&gt;如果集群中存在一些旧索引，不再有新的数据写入它们，查询频率很低但是又不能直接关闭它们，因为偶尔存在查询的需要，这时候可以考虑使用冻结索引" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#dae8fc;strokeColor=#6c8ebf;fillStyle=solid;direction=west;gradientDirection=north;shadow=1;size=20;pointerEvents=1;align=left;verticalAlign=top;spacingTop=0;spacing=6;labelBackgroundColor=none;labelBorderColor=none;" vertex="1" parent="1">
          <mxGeometry x="590" y="200" width="160" height="140" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="QRIR3LQG_rmAo_kVsJCW" name="第 2 页">
    <mxGraphModel dx="1392" dy="694" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="3300" pageHeight="4681" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
